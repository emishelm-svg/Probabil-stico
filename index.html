<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Titanic Decision Tree Visualizer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        :root {
            --sidebar-width: 300px;
            --primary-blue: #2c3e50;
            --accent-color: #3498db;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
            background-color: #f4f7f6;
        }

        /* Panel Lateral */
        #sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary-blue);
            color: white;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            z-index: 10;
        }

        /* Área Principal */
        #main-content {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        header {
            background: white;
            padding: 15px 30px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #tree-container {
            flex-grow: 1;
            overflow: auto;
            background: white;
            margin: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        /* Estilos del Árbol */
        .node circle {
            fill: #fff;
            stroke: var(--accent-color);
            stroke-width: 3px;
        }

        .node text {
            font: 12px sans-serif;
        }

        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 2px;
        }

        .controls-group {
            margin-bottom: 20px;
        }

        button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }

        button:hover { background: #2980b9; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2>Titanic Tree</h2>
    <hr>
    <div class="controls-group">
        <label>Variable Objetivo:</label>
        <p><strong>Survived</strong></p>
    </div>
    <div class="controls-group">
        <label>Profundidad Máxima:</label>
        <input type="range" min="1" max="5" value="3" id="depthRange" style="width: 100%;">
    </div>
    <button onclick="buildTree()">Entrenar Modelo</button>
</div>

<div id="main-content">
    <header>
        <h1>Visualizador de Datos: Titanic-Dataset.csv</h1>
        <div id="stats">Nodos: <span id="node-count">0</span></div>
    </header>
    
    <div id="tree-container">
        </div>
</div>

<script>
    // Estructura de datos simplificada basada en la lógica del Titanic
    // En una app real, aquí procesarías el CSV con un algoritmo de ID3 o C4.5
    const treeData = {
        name: "Sex",
        children: [
            {
                name: "Female (74% Survived)",
                children: [
                    { name: "Pclass 1 & 2: Survived" },
                    { name: "Pclass 3: 50% Survived" }
                ]
            },
            {
                name: "Male (18% Survived)",
                children: [
                    { name: "Age < 12: Survived" },
                    { name: "Age > 12: Perished" }
                ]
            }
        ]
    };

    function buildTree() {
        const container = document.getElementById("tree-container");
        container.innerHTML = ""; // Limpiar
        
        const width = container.clientWidth;
        const height = container.clientHeight;

        const svg = d3.select("#tree-container").append("svg")
            .attr("width", width)
            .attr("height", height)
            .append("g")
            .attr("transform", "translate(80,0)");

        const tree = d3.tree().size([height, width - 200]);
        const root = d3.hierarchy(treeData);
        tree(root);

        // Enlaces
        svg.selectAll(".link")
            .data(root.links())
            .enter().append("path")
            .attr("class", "link")
            .attr("d", d3.linkHorizontal()
                .x(d => d.y)
                .y(d => d.x));

        // Nodos
        const node = svg.selectAll(".node")
            .data(root.descendants())
            .enter().append("g")
            .attr("class", "node")
            .attr("transform", d => `translate(${d.y},${d.x})`);

        node.append("circle").attr("r", 10);
        node.append("text")
            .attr("dy", ".35em")
            .attr("x", d => d.children ? -13 : 13)
            .style("text-anchor", d => d.children ? "end" : "start")
            .text(d => d.data.name);

        document.getElementById("node-count").innerText = root.descendants().length;
    }

    // Carga inicial
    window.onload = buildTree;
</script>

</body>
</html>
